<!DOCTYPE html>
<html lang="pt-br">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Apex Store | Dashboard CEO</title>
  <link rel="stylesheet" href="/style.css">
  <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;600;800&display=swap" rel="stylesheet">
  <script src="https://unpkg.com/lucide@latest"></script>
  <script>
    // Função simples para verificar se o cookie de login existe
    function checkAuth() {
      const isLoggedIn = document.cookie.split(';').some((item) => item.trim().startsWith('apex_auth='));

      if (!isLoggedIn) {
        // Se não estiver logado, limpa a página e manda para o login
        document.documentElement.style.display = 'none';
        alert("Acesso restrito! Por favor, faça login.");
        window.location.href = "/admin-login";
      }
    }
    checkAuth();
  </script>
  <style>
    :root {
      --sidebar-width: 280px;
    }

    body {
      display: flex;
      background: #050505;
      color: white;
      overflow: hidden;
    }

    .sidebar {
      width: var(--sidebar-width);
      height: 100vh;
      background: rgba(10, 10, 10, 0.95);
      border-right: 1px solid rgba(139, 92, 246, 0.2);
      padding: 2rem;
      display: flex;
      flex-direction: column;
    }

    .admin-content {
      flex: 1;
      height: 100vh;
      overflow-y: auto;
      padding: 3rem;
    }

    .nav-admin {
      list-style: none;
      margin-top: 3rem;
      flex: 1;
    }

    .nav-admin li {
      padding: 1rem;
      margin-bottom: 0.5rem;
      border-radius: 8px;
      cursor: pointer;
      transition: 0.3s;
      display: flex;
      align-items: center;
      gap: 12px;
      color: rgba(255, 255, 255, 0.6);
    }

    .nav-admin li:hover,
    .nav-admin li.active {
      background: rgba(139, 92, 246, 0.1);
      color: var(--primary);
    }

    .tab-content {
      display: none;
      animation: fadeIn 0.5s ease;
    }

    .tab-content.active {
      display: block;
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(10px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
  </style>
</head>

<body>

  <aside class="sidebar">
    <div class="logo">APEX<span>DASH</span></div>
    <ul class="nav-admin">
      <li class="active" onclick="switchTab('vendas')">
        <i data-lucide="shopping-cart"></i> Ordem de Venda
      </li>
      <li onclick="switchTab('cupons')">
        <i data-lucide="tag"></i> Cupom de Desconto
      </li>
    </ul>
    <div class="user-profile" style="border-top: 1px solid rgba(255,255,255,0.1); padding-top: 1.5rem;">
      <li onclick="window.location.href='/'" style="list-style:none; cursor:pointer; color: #ef4444; display:flex; gap:10px;">
        <i data-lucide="log-out"></i> Sair do Painel
      </li>
    </div>
  </aside>

  <main class="admin-content">
    <section id="tab-vendas" class="tab-content active">
      <span class="badge">Administrativo</span>
      <h1 style="margin-top: 1rem;">Gerar Ordem de Venda</h1>
      <p style="opacity: 0.6; margin-bottom: 2.5rem;">Crie um link de pagamento direto para o seu cliente.</p>

      <div class="modal-card" style="max-width: 600px; position: relative;">
        <form id="form-venda" onsubmit="event.preventDefault();">
          <div class="input-group">
            <label>Produto / Script</label>
            <input type="text" id="venda-nome" placeholder="Ex: Sistema de Garagem v2" required>
          </div>
          <div class="input-group">
            <label>Valor (R$)</label>
            <input type="number" id="venda-valor" placeholder="Ex: 150.00" step="0.01" required>
          </div>
          <div class="input-group">
            <label>Descrição detalhada</label>
            <textarea id="venda-desc" rows="4" placeholder="O que está incluso nesta venda?"></textarea>
          </div>
          <button class="btn-primary" style="width: 100%; border:none; cursor:pointer;" onclick="gerarLink()">
            Gerar Link e Notificar Cliente <i data-lucide="link"></i>
          </button>
        </form>
        <div id="resultado-venda" style="margin-top: 1.5rem; display: none; padding: 1rem; background: rgba(16, 185, 129, 0.1); border-radius: 8px; border: 1px solid #10b981; color: #10b981; word-break: break-all;">
        </div>
      </div>
    </section>

    <section id="tab-cupons" class="tab-content">
      <span class="badge">Marketing</span>
      <h1 style="margin-top: 1rem;">Cupons de Desconto</h1>
      <p style="opacity: 0.6; margin-bottom: 2.5rem;">Gerencie códigos promocionais para sua loja.</p>

      <div class="modal-card" style="max-width: 600px;">
        <div class="input-group">
          <label>Código do Cupom</label>
          <input type="text" placeholder="Ex: APEX10">
        </div>
        <div class="input-group">
          <label>Porcentagem de Desconto (%)</label>
          <input type="number" placeholder="Ex: 10">
        </div>
        <button class="btn-secondary" style="width: 100%; border:none; cursor:pointer;">
          Ativar Cupom <i data-lucide="plus"></i>
        </button>
      </div>
    </section>
  </main>

  <script>
    lucide.createIcons();

    function switchTab(tabId) {
      document.querySelectorAll('.tab-content').forEach(tab => tab.classList.remove('active'));
      document.querySelectorAll('.nav-admin li').forEach(li => li.classList.remove('active'));

      document.getElementById('tab-' + tabId).classList.add('active');
      event.currentTarget.classList.add('active');
    }

    function gerarLink() {
      const nome = encodeURIComponent(document.getElementById('venda-nome').value);
      const valor = document.getElementById('venda-valor').value;
      const desc = encodeURIComponent(document.getElementById('venda-desc').value);

      if (!nome || !valor) return alert("Preencha os campos obrigatórios!");

      // Monta a URL com os parâmetros para o checkout ler
      const link = `${window.location.origin}/checkout?n=${nome}&v=${valor}&d=${desc}`;

      const resDiv = document.getElementById('resultado-venda');
      resDiv.style.display = "block";
      resDiv.innerHTML = `
        <strong>Link para enviar ao cliente:</strong><br>
        <small style="color:rgba(255,255,255,0.5)">${link}</small><br><br>
        <button onclick="navigator.clipboard.writeText('${link}'); alert('Link copiado!')" class="btn-secondary" style="padding: 5px 10px; font-size: 0.8rem;">
            Copiar Link
        </button>
    `;
    }
  </script>
</body>

</html>